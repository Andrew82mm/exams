## Непрерывные дроби

$$
\large{\frac{a}{b} = \frac{b \cdot a_1 + r_1}{b} = a_1 + \frac{r_1}{b} = a_1 + \frac{1}{\frac{b}{r_1}} = a_1 + \frac{1}{a_2 + \frac{r_2}{r_1}}}
$$
где:
$\large{a = b \cdot a_1 + r_1, \quad r_1 < b}$
$\large{b = r_1 \cdot a_2 + r_2, \quad r_2 < r_1}$


#### Определение:
$$
\Large{a_1 + \frac{1}{a_2 + \frac{1}{a_3 + \dots + \frac{1}{a_n}}}}
$$
Выражение такого вида называется непрерывной дробью.

#### Теорема
Любое вещественное число можно представить в виде непрерывной дроби.

- Если число рациональное, то дробь конечная.
- Если число иррациональное, то дробь бесконечная.

#### Определение
###### Пусть

$\Large{r = a_1 + \frac{1}{a_2 + \frac{1}{a_3 + \dots}}}$
###### Tогда

- $\Large{\delta_1 = \frac{a_1}{1}}$,
- $\Large{\delta_2 = a_1 + \frac{1}{a_2}}$,
- $\Large{\delta_3 = a_1 + \frac{1}{a_2 + \frac{1}{a_3}}}$
называются подходящими дробями.
--------------------------------------------------------------------------


Обозначим $\large{\delta_k = \frac{p_k}{q_k}, \quad k = 1, 2, 3, \dots}$

#### Теорема (о нахождении подходящих дробей)

$$
\large{}] p_0 = 1, q_0 = 0, p_1 = a_1, q_1 = 1. \Rightarrow
\begin{cases} p_k = a_k \cdot p_{k-1} + p_{k-2}\\
q_k = a_k \cdot q_{k-1} + q_{k-2} \end{cases}$$
#### Доказательство:

**База индукции** \( k = 2 \):   $\Large{}\delta_2 = \frac{p_2}{q_2} = \frac{a_2 \cdot a_1 + 1}{a_2}$

$\large{}p_2 = a_2 \cdot p_1 + p_0 = a_2 \cdot a_1 + 1$
$\large{}q_2 = a_2 \cdot q_1 + q_0 = a_2 \cdot 1 + 0 = a_2$
$\large{}\delta_2 = a_1 + \frac{1}{a_2} \Rightarrow \text{верно}$

**Индукционный переход $( k \to k+1 )$**:

$\Large {\delta_{k+1} = a_1 + \frac{1}{a_2 + \frac{1}{\dots a_k + \frac{1}{a_{k+1}}}}}$

**Индукционное предположение**: Пусть предположение индукции верно для \( k \):

Возьмём $\large{a_k + \frac{1}{a_{k+1}}}$ как за одно число $\large{}a_k$ , тогда по предположению индукции получим:

$\large{p_k = \left(a_k + \frac{1}{a_{k+1}}\right) \cdot p_{k-1} + p_{k-2} = \Large{}\frac{a_k \cdot a_{k+1} \cdot p_{k-1} + p_{k-2}}{a_{k+1}} + \frac{a_{k+1} \cdot p_{k-1}}{a_{k+1}} = \frac{a_{k+1} \cdot p_k + p_{k-1}}{a_{k+1}}}$

Для $\large{}q_k$ проделываем тоже самое и получаем $\Large{}\frac{a_{k+1} \cdot q_k + q_{k-1}}{a_{k+1}}$ 
Поделив $\large{} p_k$ на $\large{} q_k$ мы получаем $\Large{}\frac{a_{k+1} \cdot p_k + p_{k-1}}{a_{k+1} \cdot q_k + q_{k-1}}$, что равняется $\large{}\delta_{k+1}$ ■

--------------------------------------------------------------------------
#### Следствие
Для $( k = 2, 3, \dots )$ выполняется:
$$
\large{}p_k \cdot q_{k-1} - p_{k-1} \cdot q_k = (-1)^k
$$

##### Доказательство (математическая индукция)

**База индукции** (\( k = 2 \)):

Подставим значения для \( k = 2 \):
$$
\large{}p_2 \cdot q_1 - p_1 \cdot q_2 = (a_2 \cdot a_1 + 1) \cdot 1 - a_1 \cdot a_2 = a_2 \cdot a_1 + 1 - a_2 \cdot a_1 = 1
$$
>Вы спросите меня, почему тут так получается. Давайте разберем. Вспомним, что  $\large{\delta_1 = \frac{a_1}{1}}$,
 $\large{\delta_2 = \frac{a_1 \cdot a_2 +1}{a_2}}$, и что $\large{\delta_k = \frac{p_k}{q_k}}$ $\Rightarrow$ мы можем однозначно сказать, что $p_2 = a_1 \cdot a_2 + 1$, $q_2 = a_2$, а то что $p_1 = a_1, q_1 = 1$ мы знаем из условия теоремы о нахождении подходящих дробей.


Так как $( (-1)^2 = 1 )$, база индукции верна.

**Индукционное предположение**:

Предположим, что для некоторого \( k = n \) выполняется:
$$
\large{}p_n \cdot q_{n-1} - p_{n-1} \cdot q_n = (-1)^n
$$

**Индукционный переход**:

Докажем, что это равенство выполняется для $( k = n + 1 )$, то есть:
$$
\large{}p_{n+1} \cdot q_n - p_n \cdot q_{n+1} = (-1)^{n+1}
$$

Используем ранее доказанные равенства:
$$
\large{}p_{n+1} = a_{n+1} \cdot p_n + p_{n-1}
$$
$$
\large{}q_{n+1} = a_{n+1} \cdot q_n + q_{n-1}
$$

Подставим эти выражения в левую часть:
$$
\large{}p_{n+1} \cdot q_n - p_n \cdot q_{n+1} = (a_{n+1} \cdot p_n + p_{n-1}) \cdot q_n - p_n \cdot (a_{n+1} \cdot q_n + q_{n-1})
$$
$$
\large{}= a_{n+1} \cdot p_n \cdot q_n + p_{n-1} \cdot q_n - a_{n+1} \cdot p_n \cdot q_n - p_n \cdot q_{n-1}
$$

Сократим одинаковые члены $\large{}( a_{n+1} \cdot p_n \cdot q_n )$:
$$
\large{}= p_{n-1} \cdot q_n - p_n \cdot q_{n-1}
$$

По индукционному предположению, мы знаем, что $\large{}( p_n \cdot q_{n-1} - p_{n-1} \cdot q_n = (-1)^n )$. Следовательно:
$$
\large{}p_{n+1} \cdot q_n - p_n \cdot q_{n+1} = -(-1)^n = (-1)^{n+1}
$$
$\Rightarrow$ утверждение верно для всех $( k \geq 2)$. ■

--------------------------------------------------------------------------
#### Следствие 2

$\large{a x \equiv b \pmod{m}}$ при условии $\large{(a, m) = 1}$

$\large{X \equiv (-1)^{n-1} \cdot p_{n-1} \cdot b \pmod{m}}$,  где $\large{p_{n-1}}$ — числитель подходящей дроби $\large{\delta_{n-1}}$ при разложении $\large{\frac{m}{a}}$ в непрерывную дробь.

#### Доказательство:

Пусть:
$\large{\delta_{n-1} = \frac{p_{n-1}}{q_{n-1}}}$ — подходящая дробь, $\large{\delta_n = \frac{m}{a}}$.

По следствию:
$\large{m \cdot q_{n-1} - p_{n-1} \cdot a = (-1)^n \pmod {m}}$
$\Rightarrow\large{-p_{n-1} \cdot a \equiv (-1)^n} \pmod{m}$

Таким образом:
$\large{(-1)^{n-1} \cdot b \cdot p_{n-1} \cdot a \equiv b} \pmod{m}$

Обозначим левую часть (до а) через $X$:
В силу ! решения сравнения $\large{X \equiv (-1)^{n-1} \cdot b \cdot p_{n-1}} \pmod{m}$ ■
